{"_id":"0JHKuWXyrFvR7Pv0","name":"Aura of Vitality","type":"spell","img":"icons/magic/holy/barrier-shield-winged-blue.webp","data":{"description":{"value":"","chat":"<p>Healing energy radiates from you in an aura with a 30-foot radius. Until the spell ends, the aura moves with you, centered on you. You can use a bonus action to cause one creature in the aura (including you) to regain 2d6 hit points.</p>","unidentified":"<p>Healing energy radiates from you in an aura with a 30-foot radius. Until the spell ends, the aura moves with you, centered on you. You can use a bonus action to cause one creature in the aura (including you) to regain 2d6 hit points.</p>"},"source":"Player's Handbook , pg. 216","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":30,"long":null,"units":"ft"},"uses":{"value":0,"max":"0","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"heal","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":null},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":3,"school":"evo","components":{"value":"","vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""},"attributes":{"spelldc":10},"attunement":0},"effects":[{"_id":"l6ntxjpimprip38b","changes":[{"key":"macro.tokenMagic","mode":0,"value":"glacial-aura","priority":"20"}],"disabled":false,"duration":{"startTime":null},"icon":"icons/magic/holy/barrier-shield-winged-blue.webp","label":"Aura of Vitality","origin":"Actor.FzHGnPGyw01MRHXm.Item.sTiwetZlEawz5RLi","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":false},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"dnd5e-helpers":{"rest-effect":"Ignore"}},"tint":null,"selectedKey":"macro.tokenMagic"}],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"favtab":{"isFavorite":false},"midi-qol":{"onUseMacroName":"[postActiveEffects]ItemMacro","effectActivation":false},"core":{"sourceId":"Item.sTiwetZlEawz5RLi"},"itemacro":{"macro":{"data":{"_id":null,"name":"Aura of Vitality","type":"script","author":"U3VAAELfq3wUHjF9","img":"icons/svg/dice-target.svg","scope":"global","command":"actor = await fromUuid(args[0].actorUuid);\nconst itemData = {\n    name: args[0].itemData.name + \" Cure\",\n    type: \"feat\",\n    img: args[0].itemData.img,\n    data: {\n        actionType: \"heal\",\n        activation: {type: \"bonus\"},\n        damage: {parts: [[\"2d6\", \"healing\"]]},\n        target: {value: 1, type: \"creature\"},\n        range: {value: 30, units: \"ft\"}\n    }\n};\nconst items = (await actor.createEmbeddedDocuments(\"Item\", [itemData])).map(i=> i.uuid);\nlet removeUuids = getProperty(actor.data.flags, \"midi-qol.concentration-data.removeUuids\") ?? [];\nremoveUuids = removeUuids.concat(items);\nif (removeUuids.length > 0) actor.setFlag(\"midi-qol\", \"concentration-data.removeUuids\", removeUuids);","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"scene-packer":{"sourceId":"Item.urv1FhMSln45WemZ","hash":"8e7c5b9b02f5a25bb5dfe4e1c47f3e816366f93a"},"exportSource":{"world":"tp-game-v3","system":"dnd5e","coreVersion":"9.249","systemVersion":"1.5.7"},"betterRolls5e":{"quickOther":{"context":"","value":true,"altValue":true},"quickDesc":{"value":true,"altValue":true},"quickProperties":{"value":true,"altValue":true},"quickVersatile":{"value":false,"altValue":false},"quickFlavor":{"value":true,"altValue":true},"quickDamage":{"context":{"0":""}}},"cf":{"id":"temp_ovon30cu8t"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false}}}
{"name":"Lightning Bolt","type":"spell","img":"systems/dnd5e/icons/spells/lightning-blue-2.jpg","data":{"description":{"value":"<p>A stroke of lightning forming a line 100 feet long and 5 feet wide blasts out from you in a direction you choose. Each creature in the line must make a Dexterity saving throw. A creature takes 8d6 lightning damage on a failed save, or half as much damage on a successful one.</p><p>The lightning ignites flammable objects in the area that aren't being worn or carried.</p><p><strong>At Higher Levels.</strong> When you cast this spell using a spell slot of 4th level or higher, the damage increases by 1d6 for each slot level above 3rd.</p>","chat":"","unidentified":""},"source":"PHB pg. 255","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":null,"units":"inst"},"target":{"value":100,"width":null,"units":"ft","type":"line"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":0,"per":""},"consume":{"type":"","target":null,"amount":null},"ability":"","actionType":"save","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["8d6","lightning"]],"versatile":""},"formula":"","save":{"ability":"dex","dc":0,"scaling":"spell"},"level":3,"school":"evo","components":{"value":"","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"A bit of fur and a rod of amber, crystal, or glass","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"1d6"},"attunement":null},"effects":[],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Compendium.dnd5e.spells.IyikgTEOTv701jgQ"}},"_id":"1eLQT003NZm8qC3S"}
{"name":"Spirit Guardians","type":"spell","img":"systems/dnd5e/icons/spells/needles-sky-2.jpg","data":{"description":{"value":"<p>You call forth spirits to protect you. They flit around you to a distance of 15 feet for the duration. If you are good or neutral, their spectral form appears angelic or fey (your choice). If you are evil, they appear fiendish.</p><p>When you cast this spell, you can designate any number of creatures you can see to be unaffected by it. An affected creature's speed is halved in the area, and when the creature enters the area for the first time on a turn or starts its turn there, it must make a Wisdom saving throw. On a failed save, the creature takes 3d8 radiant damage (if you are good or neutral) or 3d8 necrotic damage (if you are evil). On a successful save, the creature takes half as much damage.</p><p><strong>At Higher Levels.</strong> When you cast this spell using a spell slot of 4th level or higher, the damage increases by 1d8 for each slot level above 3rd.</p>","chat":"","unidentified":""},"source":"PHB pg. 278","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":10,"units":"minute"},"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"0","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":0,"scaling":"spell"},"level":3,"school":"con","components":{"value":"","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"A holy symbol","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"1d8"},"attunement":0},"effects":[{"_id":"lpdhf0z948gfdj4c","changes":[{"key":"macro.itemMacro.GM","mode":0,"value":"@spellLevel @attributes.spelldc","priority":"20"}],"disabled":false,"duration":{"startTime":null,"seconds":600,"rounds":100},"icon":"systems/dnd5e/icons/spells/needles-sky-2.jpg","label":"Spirit Guardians","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":false}},"tint":null,"selectedKey":"macro.itemMacro.GM"}],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Compendium.dnd5e.spells.uCud2s4TjMfjiXUb"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"selfEffect":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Spirit Guardians","type":"script","author":"U3VAAELfq3wUHjF9","img":"icons/svg/dice-target.svg","scope":"global","command":"const damageType = 'radiant'\nconst lastArg = args[args.length-1];\nconst casterToken = (await fromUuid(lastArg.tokenUuid)).object\nconst spellDC = args[2];\nconst spellLevel = args[1];\nconst item = await fromUuid(lastArg.origin)\nif(args[0] === \"on\"){\n    let damagedThisTurn = []\n    let hookId1 = Hooks.on(\"preUpdateTokenGM\",(token,changes,options,userId)=>{\n        if(!('x' in changes||'y' in changes))return;\n        let desl = token.data.height*canvas.scene.dimensions.size/2;\n        let finalPositionX = changes.x??token.data.x;\n        let finalPositionY = changes.y??token.data.y;\n        if(token.id === casterToken.id){\n            for(let tokenT of canvas.scene.tokens.map(i=>i)){\n                if(tokenT.data.disposition === casterToken.data.disposition)continue;\n                if(canvas.grid.measureDistance({x:finalPositionX+desl,y:finalPositionY+desl},tokenT.object.center) > 15){\n                    tokenT.actor.deleteEmbeddedDocuments(\"ActiveEffect\",tokenT.actor.effects.filter(i=>i.data.origin === lastArg.origin).map(i=>i.id))\n                    continue;\n                }\n                applyEffect(tokenT)            \n            }\n            return;\n        }\n        if(token.data.disposition === casterToken.data.disposition)return;        \n        if(canvas.grid.measureDistance({x:finalPositionX+desl,y:finalPositionY+desl},casterToken.center) > 15){\n            token.actor.deleteEmbeddedDocuments(\"ActiveEffect\",token.actor.effects.filter(i=>i.data.origin === lastArg.origin).map(i=>i.id));\n            return;\n        }\n        if(canvas.grid.measureDistance(token.object.center,casterToken.center) <= 15)return;     \n        applyEffect(token)\n        if(damagedThisTurn.includes(token))return;\n        damagedThisTurn.push(token);\n        applyDamage(token)\n    })\n    let hookId2 = Hooks.on(\"updateCombat\",(combat,turn,opions,userId)=>{\n        let token = canvas.tokens.get(combat.current.tokenId)\n        if(token.data.disposition === casterToken.data.disposition)return;\n        if(canvas.grid.measureDistance(token.center,casterToken.center) > 15)return;\n        applyEffect(token)\n        applyDamage(token)\n    })\n    DAE.setFlag(casterToken.actor,\"SpiritGuardianHooks\",[hookId1,hookId2])\n    for(let token of canvas.scene.tokens.map(i=>i)){\n        if(token.data.disposition === casterToken.data.disposition)continue;\n        if(canvas.grid.measureDistance(token.object.center,casterToken.center) > 15)continue;\n        applyEffect(token)\n    }\n}\nif(args[0] === \"off\"){\n    hookIds = DAE.getFlag(casterToken.actor,\"SpiritGuardianHooks\")\n    Hooks.off(\"preUpdateTokenGM\",hookIds[0])\n    Hooks.off(\"updateCombat\",hookIds[1])\n    for(let token of canvas.scene.tokens.map(i=>i)){\n        token.actor.deleteEmbeddedDocuments(\"ActiveEffect\",token.actor.effects.filter(i=>i.data.label === \"Spirit Guardians Movement Reduction\").map(i=>i.id))\n    }\n}\nasync function applyDamage(token){\n    let tokenUuid = token.uuid??token.document.uuid\n    let damageItem = await casterToken.actor.createEmbeddedDocuments(\"Item\",[getItemData()])\n    await MidiQOL.completeItemRoll(damageItem[0], {targetUuids: [tokenUuid]});\n    await casterToken.actor.deleteEmbeddedDocuments(\"Item\",[damageItem[0].id])\n}\nasync function applyEffect(token){\n    if(token.actor.effects.find(i=>i.data.label === \"Spirit Guardians Movement Reduction\"))return;\n    effectData = {\n        \"changes\": [\n            {\n                \"key\": \"data.attributes.movement.walk\",\n                \"mode\": 1,\n                \"value\": 0.5,\n                \"priority\": \"20\"\n            }\n        ],\n        \"disabled\": false,\n        \"origin\":lastArg.origin,\n        \"duration\": {\n            \"startTime\": null,\n            \"seconds\": 600,\n            \"rounds\": 100\n        },\n        \"icon\": \"systems/dnd5e/icons/spells/needles-sky-2.jpg\",\n        \"label\": \"Spirit Guardians Movement Reduction\",\n        \"tint\": \"\",\n        \"transfer\": false,\n    }\n    await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: token.actor.uuid, effects: [effectData]});\n}\n\nfunction getItemData(){\n    return {\n        name: item.name + \" Damage\",\n        type: \"spell\",\n        img: item.img,\n        data: {\n            description: {\n                    value: \"\"},\n            actionType: \"save\",\n            activation: {type: \"none\"},\n            damage: {parts: [[`${spellLevel}d8`, `${damageType}`]]},\n            save: {ability: \"wis\",dc: null,scaling: \"spell\"},\n            level: 0,\n            school: \"con\",\n        }\n    };\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}}},"_id":"9We9JAhkzccgO9f4"}
{"name":"Fireball","type":"spell","img":"systems/dnd5e/icons/spells/fireball-red-2.jpg","data":{"description":{"value":"<p>A bright streak flashes from your pointing finger to a point you choose within range and then blossoms with a low roar into an explosion of flame. Each creature in a 20-foot-radius sphere centered on that point must make a Dexterity saving throw. A target takes 8d6 fire damage on a failed save, or half as much damage on a successful one.</p><p>The fire spreads around corners. It ignites flammable objects in the area that aren't being worn or carried.</p><p><strong>Higher Levels.</strong> When you cast this spell using a spell slot of 4th level or higher, the damage increases by 1d6 for each slot level above 3rd.</p>","chat":"","unidentified":""},"source":"PHB pg. 241","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":null,"units":"inst"},"target":{"value":20,"width":null,"units":"ft","type":"sphere"},"range":{"value":150,"long":0,"units":"ft"},"uses":{"value":0,"max":0,"per":""},"consume":{"type":"","target":null,"amount":null},"ability":"","actionType":"save","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["8d6","fire"]],"versatile":""},"formula":"","save":{"ability":"dex","dc":0,"scaling":"spell"},"level":3,"school":"evo","components":{"value":"","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"A tiny ball of bat guano and sulfur","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"1d6"},"attunement":null},"effects":[],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Compendium.dnd5e.spells.ztgcdrWPshKRpFd0"}},"_id":"Fay2ibvIqmDc9ls1"}
{"_id":"IsuUmP3Qh003cwFo","name":"Elemental Weapon","type":"spell","img":"icons/magic/light/swords-light-glowing-white.webp","data":{"description":{"value":"","chat":"","unidentified":""},"source":"Player's Handbook","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"hour"},"target":{"value":null,"width":null,"units":"touch","type":"creature"},"range":{"value":null,"long":null,"units":"touch"},"uses":{"value":null,"max":"","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":3,"school":"trs","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"cantrip","formula":""},"attunement":null},"effects":[{"_id":"6milzj1niyubx29o","changes":[{"key":"macro.itemMacro","mode":0,"value":"@spellLevel","priority":"20"}],"disabled":false,"duration":{"startTime":null},"icon":"icons/magic/light/swords-light-glowing-white.webp","label":"Elemental Weapon","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":false}},"tint":null,"selectedKey":"macro.itemMacro"}],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Item.gQT59af5OmOeahBo"},"itemacro":{"macro":{"data":{"_id":null,"name":"Elemental Weapon","type":"script","author":"U3VAAELfq3wUHjF9","img":"icons/svg/dice-target.svg","scope":"global","command":"//DAE Item Macro Execute, arguments = @item.level\n    const { actor, token, lArgs } = targets(args)\n    const DAEItem = lArgs.efData.flags.dae.itemData\n    let weapons = actor.items.filter(i => i.data.type === `weapon`);\n    let weapon_content = ``;\n    function value_limit(val, min, max) {\n        return val < min ? min : (val > max ? max : val);\n    };\n    //Filter for weapons\n    for (let weapon of weapons) {\n        weapon_content += `<label class=\"radio-label\">\n            <input type=\"radio\" name=\"weapon\" value=\"${weapon.id}\" checked>\n            <img src=\"${weapon.img}\" style=\"border:0px; width: 50px; height:50px;\">\n            ${weapon.data.name}\n        </label>`;\n    }\n    let elementsContent = `\n    <label for=\"element\">Choose a Element:</label>\n    <select id=\"element\">\n        <option value=\"acid\">Acid</option>\n        <option value=\"cold\">Cold</option>\n        <option value=\"fire\">Fire</option>\n        <option value=\"lightning\">Lightning</option>\n        <option value=\"thunder\">Thunder</option>\n    </select>`\n\n    /**\n     * Select for weapon and apply bonus based on spell level\n     */\n    if (args[0] === \"on\") {\n        let content = `\n            <form class=\"elementalWeapon\">\n            <div class=\"form-group\" id=\"weapons\">\n                ${weapon_content}\n            </div>\n            </form>\n            ${elementsContent}\n            `;\n\n        new Dialog({\n            content,\n            buttons:\n            {\n                Ok:\n                {\n                    label: `Ok`,\n                    callback: async (html) => {\n                        let itemId = $(\"input[type='radio'][name='weapon']:checked\").val();\n                        let damageType = html.find('select#element')[0].value;\n                        let weaponItem = actor.items.get(itemId);\n                        let copy_item = duplicate(weaponItem);\n                        let spellLevel = Math.floor(args[1] / 2);\n                        let bonus = value_limit(spellLevel, 1, 3);\n                        let wpDamage = copy_item.data.damage.parts;\n                        let verDamage = copy_item.data.damage.versatile;\n                        await DAE.setFlag(actor, `elementalWeapon`, {\n                            damage: weaponItem.data.data.attackBonus,\n                            weapon: itemId,\n                            weaponDmg: wpDamage,\n                            verDmg: verDamage,\n                            mgc: copy_item.data.properties.mgc\n                        }\n                        );\n                        if (copy_item.data.attackBonus === \"\") copy_item.data.attackBonus = \"0\"\n                        copy_item.data.attackBonus = `${parseInt(copy_item.data.attackBonus) + bonus}`;\n                        copy_item.data.damage.parts.push([`${bonus}d4`,damageType])\n                        copy_item.data.properties.mgc = true\n                        if (verDamage !== \"\" && verDamage !== null) copy_item.data.damage.versatile = (verDamage + \" + \" + bonus);\n                        await actor.updateEmbeddedDocuments(\"Item\", [copy_item]);\n                    }\n                },\n                Cancel:\n                {\n                    label: `Cancel`\n                }\n            }\n        }).render(true);\n    }\n\n    //Revert weapon and unset flag.\n    if (args[0] === \"off\") {\n        let { damage, weapon, weaponDmg, verDmg, mgc } = DAE.getFlag(actor, 'elementalWeapon');\n        let weaponItem = actor.items.get(weapon);\n        let copy_item = duplicate(weaponItem);\n        copy_item.data.attackBonus = damage;\n        copy_item.data.damage.parts = weaponDmg;\n        copy_item.data.properties.mgc = mgc\n        if (verDmg !== \"\" && verDmg !== null) copy_item.data.damage.versatile = verDmg;\n        await actor.updateEmbeddedDocuments(\"Item\", [copy_item]);\n        await DAE.unsetFlag(actor, `elementalWeapon`);\n    }\n\nfunction targets(args) {\n    const lastArg = args[args.length - 1];\n    let tactor, ttoken;\n    if (lastArg.tokenId) {\n        ttoken = canvas.tokens.get(lastArg.tokenId);\n        tactor = ttoken.actor\n    }\n    else tactor = game.actors.get(lastArg.actorId);\n    return { actor: tactor, token: ttoken, lArgs: lastArg }\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}}}}
{"name":"Slow","type":"spell","img":"systems/dnd5e/icons/spells/fog-magenta-2.jpg","data":{"description":{"value":"<p>You alter time around up to six creatures of your choice in a 40-foot cube within range. Each target must succeed on a Wisdom saving throw or be affected by this spell for the duration.</p><p>An affected target's speed is halved, it takes a -2 penalty to AC and Dexterity saving throws, and it can't use reactions. On its turn, it can use either an action or a bonus action, not both. Regardless of the creature's abilities or magic items, it can't make more than one melee or ranged attack during its turn.</p><p>If the creature attempts to cast a spell with a casting time of 1 action, roll a d20. On an 11 or higher, the spell doesn't take effect until the creature's next turn, and the creature must use its action on that turn to complete the spell. If it can't, the spell is wasted.</p><p>A creature affected by this spell makes another Wisdom saving throw at the end of its turn. On a successful save, the effect ends for it.</p>","chat":"","unidentified":""},"source":"PHB pg. 277","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":40,"width":null,"units":"ft","type":"cube"},"range":{"value":120,"long":0,"units":"ft"},"uses":{"value":0,"max":"0","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":"","value":""},"formula":"","save":{"ability":"wis","dc":null,"scaling":"spell"},"level":3,"school":"trs","components":{"value":"","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"A drop of molasses.","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""},"attunement":null},"effects":[{"_id":"rb8hlzejt2hspexs","changes":[{"key":"data.attributes.ac.bonus","mode":2,"value":"-2","priority":"20"},{"key":"data.attributes.movement.all","mode":0,"value":"/2","priority":"20"}],"disabled":false,"duration":{"startTime":null},"icon":"systems/dnd5e/icons/spells/fog-magenta-2.jpg","label":"Slow","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":false}},"tint":null,"selectedKey":["data.attributes.ac.bonus","data.attributes.movement.all"]}],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Compendium.dnd5e.spells.yqUDoxk4x0NWG5Bz"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false}},"_id":"KLQwVSoTO8CHpnVD"}
{"_id":"MCsRCfA4jhw0XemU","name":"Blinding Smite","type":"spell","img":"icons/magic/perception/eye-ringed-glow-angry-large-red.webp","data":{"description":{"value":"","chat":"","unidentified":""},"source":"Player's Handbook","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":3,"school":"evo","components":{"value":"","vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"cantrip","formula":""},"attunement":null},"effects":[{"_id":"klcu5k5qu1hmaogh","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro.Blinding Smite","priority":"20"}],"disabled":false,"duration":{"startTime":null},"icon":"icons/magic/perception/eye-ringed-glow-angry-large-red.webp","label":"Blinding Smite","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":["1Hit:mwak"],"transfer":false}},"tint":null,"selectedKey":"flags.dnd5e.DamageBonusMacro"}],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Item.mez0y7mrQ3EC1VnN"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Blinding Smite","type":"script","author":"U3VAAELfq3wUHjF9","img":"icons/svg/dice-target.svg","scope":"global","command":"if(args[0].macroPass != 'DamageBonus')return;\nif(args[0].item.data.actionType != \"mwak\")return;\nif(args[0].targetUuids.length < 1)return;\nconst casterToken = await fromUuid(args[0].tokenUuid);\nconst casterActor = casterToken.token;\nconst [item] = await actor.createEmbeddedDocuments(\"Item\", [getItemData()]);\nawait MidiQOL.completeItemRoll(item, {targetUuids: args[0].targetUuids});\nlet concentrationTargets = getProperty(actor.data.flags, \"midi-qol.concentration-data.targets\") ?? [];\nconcentrationTargets = concentrationTargets.concat([{tokenUuid:args[0].targetUuids[0],actorUuid:args[0].targetUuids[0]}]);\nif (concentrationTargets.length > 0) actor.setFlag(\"midi-qol\", \"concentration-data.targets\", concentrationTargets);\nactor.setFlag(\"midi-qol\", \"concentration-data.uuid\", item.uuid);\nactor.deleteEmbeddedDocuments(\"Item\", [item.id])\n\nfunction getItemData(){\n    return {\n        \"name\": \"Blinding Smite Effect\",\n        \"type\": \"spell\",\n        \"img\": \"icons/magic/perception/eye-ringed-glow-angry-large-red.webp\",\n        \"data\": {\n            \"description\": {\n                \"value\": \"<p>The target must succeed on a Constitution saving throw or be blinded until the spell ends.</p>\",\n                \"chat\": \"\",\n                \"unidentified\": \"\"\n            },\n            \"source\": \"\",\n            \"activation\": {\n                \"type\": \"none\",\n                \"cost\": 0,\n                \"condition\": \"\"\n            },\n            \"duration\": {\n                \"value\": null,\n                \"units\": \"\"\n            },\n            \"target\": {\n                \"value\": null,\n                \"width\": null,\n                \"units\": \"\",\n                \"type\": \"\"\n            },\n            \"range\": {\n                \"value\": null,\n                \"long\": null,\n                \"units\": \"\"\n            },\n            \"uses\": {\n                \"value\": null,\n                \"max\": \"\",\n                \"per\": \"\"\n            },\n            \"consume\": {\n                \"type\": \"\",\n                \"target\": \"\",\n                \"amount\": null\n            },\n            \"ability\": \"\",\n            \"actionType\": \"save\",\n            \"attackBonus\": 0,\n            \"chatFlavor\": \"\",\n            \"critical\": {\n                \"threshold\": null,\n                \"damage\": \"\"\n            },\n            \"damage\": {\n                \"parts\": [],\n                \"versatile\": \"\"\n            },\n            \"formula\": \"\",\n            \"save\": {\n                \"ability\": \"con\",\n                \"dc\": null,\n                \"scaling\": \"spell\"\n            },\n            \"level\": 0,\n            \"school\": \"evo\",\n            \"components\": {\n                \"value\": \"\",\n                \"vocal\": false,\n                \"somatic\": false,\n                \"material\": false,\n                \"ritual\": false,\n                \"concentration\": false\n            },\n            \"materials\": {\n                \"value\": \"\",\n                \"consumed\": false,\n                \"cost\": 0,\n                \"supply\": 0\n            },\n            \"preparation\": {\n                \"mode\": \"innate\",\n                \"prepared\": false\n            },\n        },\n        \"effects\": [\n            {\n                \"changes\": [\n                    {\n                        \"key\": \"flags.midi-qol.disadvantage.attack.all\",\n                        \"mode\": 2,\n                        \"value\": \"0\",\n                        \"priority\": \"20\"\n                    },\n                    {\n                        \"key\": \"flags.midi-qol.grants.advantage.attack.all\",\n                        \"mode\": 2,\n                        \"value\": \"0\",\n                        \"priority\": \"20\"\n                    },\n                    {\n                        \"key\": \"flags.midi-qol.OverTime\",\n                        \"mode\": 2,\n                        \"value\": \"turn=end,\\nsaveAbility=con,\\nsaveDC=@attributes.spelldc,\\nlabel=Blinded\",\n                        \"priority\": \"20\"\n                    }\n                ],\n                \"disabled\": false,\n                \"duration\": {\n                    \"startTime\": null,\n                    \"seconds\": 60,\n                    \"rounds\": 10\n                },\n                \"icon\": \"icons/magic/perception/eye-ringed-glow-angry-large-red.webp\",\n                \"label\": \"Blinded\",\n                \"transfer\": false,\n                \"flags\": {\n                    \"core\": {\n                        \"statusId\": \"\"\n                    },\n                    \"dae\": {\n                        \"stackable\": \"none\",\n                        \"durationExpression\": \"\",\n                        \"macroRepeat\": \"none\",\n                        \"specialDuration\": [],\n                        \"transfer\": false\n                    }\n                },\n                \"tint\": \"\",\n                \"selectedKey\": [\n                    \"flags.midi-qol.disadvantage.attack.all\",\n                    \"flags.midi-qol.grants.advantage.attack.all\",\n                    \"flags.midi-qol.OverTime\"\n                ]\n            }\n        ]\n    }\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}}}}
{"_id":"MqfIFAxvwoEGftcv","name":"Hunger Of Hadar","type":"spell","img":"icons/magic/unholy/orb-swirling-teal.webp","data":{"description":{"value":"","chat":"","unidentified":""},"source":"Player's Handbook","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":20,"width":null,"units":"ft","type":"sphere"},"range":{"value":150,"long":null,"units":""},"uses":{"value":null,"max":"","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":3,"school":"con","components":{"value":"","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"a pickled octopus tentacle","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"cantrip","formula":""},"attunement":null},"effects":[],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Item.m8dZ66e2aTsQyDYg"},"itemacro":{"macro":{"data":{"_id":null,"name":"Hunger Of Hadar","type":"script","author":"U3VAAELfq3wUHjF9","img":"icons/svg/dice-target.svg","scope":"global","command":"let itemUuid = args[0].uuid\nlet templateUuid = args[0].templateUuid\nactor.createEmbeddedDocuments(\"ActiveEffect\",[getEffectData()])\nfunction getEffectData(){\n    return {\n        \"changes\": [\n            {\n                \"key\": \"macro.itemMacro.GM\",\n                \"mode\": 0,\n                \"value\": \"0\",\n                \"priority\": \"20\"\n            }\n        ],\n        \"disabled\": false,\n        \"icon\": args[0].itemData.img,\n        \"label\": args[0].itemData.name + \" Effect\",\n        \"origin\": itemUuid,\n        \"transfer\": false,\n        \"flags\": {\n            \"dae\": {\n                \"itemData\": {\n                    \"flags\": {\n                        \"itemacro\": {\n                            \"macro\": {\n                                \"data\": {\n                                    \"_id\": null,\n                                    \"type\": \"script\",\n                                    \"command\": getCommand(),\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n\nfunction getCommand(){\n    return`const templateUuid = \\\"${templateUuid}\\\"\\nconst lastArg = args[args.length-1];\\nconst casterToken = await fromUuid(lastArg.tokenUuid);\\nconst casterActor = casterToken.actor;\\nconst item = await fromUuid(lastArg.origin)\\nif(args[0] === \\\"on\\\"){\\n    let template = await fromUuid(templateUuid);\\n    let hookId = Hooks.on(\\\"updateCombat\\\",async(document)=>{\\n        let currentToken = canvas.tokens.get(document.current.tokenId);\\n        let previousToken = canvas.tokens.get(document.previous.tokenId);\\n        let x = template.data.x;\\n        let y = template.data.y;\\n        if(canvas.grid.measureDistance(currentToken,{x,y})<=20){\\n            let [item] = await casterActor.createEmbeddedDocuments(\\\"Item\\\",[getitemDataColdDamage()]);\\n            await MidiQOL.completeItemRoll(item, {targetUuids: [currentToken.document.uuid]});\\n            await casterActor.deleteEmbeddedDocuments(\\\"Item\\\",[item.id])\\n        }\\n        if(canvas.grid.measureDistance(previousToken,{x,y})<=20){\\n            let [item2] = await casterActor.createEmbeddedDocuments(\\\"Item\\\",[getitemDataNecroticDamage()]);\\n            await MidiQOL.completeItemRoll(item2, {targetUuids: [previousToken.document.uuid]});\\n            await casterActor.deleteEmbeddedDocuments(\\\"Item\\\",[item2.id])\\n        }\\n    })\\n    DAE.setFlag(casterActor,\\\"hungerOfHadarHookId\\\",hookId)\\n}\\nif(args[0] === \\\"off\\\"){\\n    Hooks.off(\\\"updateCombat\\\",DAE.getFlag(casterActor,\\\"hungerOfHadarHookId\\\"))\\n    DAE.unsetFlag(casterActor,\\\"hungerOfHadarHookId\\\")\\n}\\nfunction getitemDataColdDamage(){\\n    return {\\n        name: item.data.name + \\\"Cold Damage\\\",\\n        type: \\\"spell\\\",\\n        img: item.data.img,\\n        data: {\\n            actionType: \\\"util\\\",\\n            activation: {type: \\\"none\\\"},\\n            damage: {parts: [[\\\"2d6\\\", \\\"cold\\\"]]},\\n            level:0,\\n            school: \\\"con\\\"\\n        }\\n    };\\n}\\nfunction getitemDataNecroticDamage(){\\n    return {\\n        name: item.data.name + \\\"Cold Damage\\\",\\n        type: \\\"spell\\\",\\n        img: item.data.img,\\n        data: {\\n            actionType: \\\"save\\\",\\n            save: {ability: 'dex'},\\n            activation: {type: \\\"none\\\"},\\n            damage: {parts: [[\\\"2d6\\\", \\\"necrotic\\\"]]},\\n            level:0,\\n            school: \\\"con\\\"\\n        }\\n    };\\n}`\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false}}}
{"name":"Mass Healing Word","type":"spell","img":"systems/dnd5e/icons/spells/heal-jade-3.jpg","data":{"description":{"value":"<p>As you call out words of restoration, up to six creatures of your choice that you can see within range regain hit points equal to 1d4 + your spellcasting ability modifier. This spell has no effect on undead or constructs.</p><p><strong>At Higher Levels.</strong> When you cast this spell using a spell slot of 4th level or higher, the healing increases by 1d4 for each slot level above 3rd.</p>","chat":"","unidentified":""},"source":"PHB pg. 258","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":null,"units":"inst"},"target":{"value":6,"width":null,"units":"","type":"creature"},"range":{"value":60,"long":0,"units":"ft"},"uses":{"value":0,"max":"0","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"heal","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["1d4 + @mod","healing"]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell","value":""},"level":3,"school":"evo","components":{"value":"","vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"1d4"},"attunement":null},"effects":[],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Compendium.dnd5e.spells.34ddoYIrnOZ2GFYi"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false}},"_id":"QWF0bfAlHJdGjqAv"}
{"name":"Beacon of Hope","type":"spell","img":"systems/dnd5e/icons/spells/light-sky-3.jpg","data":{"description":{"value":"<p>This spell bestows hope and vitality. Choose any number of creatures within range. For the duration, each target has advantage on Wisdom saving throws and death saving throws, and regains the maximum number of hit points possible from any healing.</p>","chat":"","unidentified":""},"source":"PHB pg. 217","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":30,"width":null,"units":"ft","type":"ally"},"range":{"value":30,"long":0,"units":"ft"},"uses":{"value":0,"max":"0","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":"","value":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell","value":""},"level":3,"school":"abj","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""},"attunement":null},"effects":[{"_id":"mh5mzuyedth14pwb","changes":[{"key":"flags.midi-qol.advantage.ability.save.wis","mode":2,"value":"0","priority":"20"},{"key":"flags.midi-qol.max.damage.heal","mode":2,"value":"0","priority":"20"}],"disabled":false,"duration":{"startTime":null,"seconds":60,"rounds":10},"icon":"systems/dnd5e/icons/spells/light-sky-3.jpg","label":"Beacon of Hope","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":false}},"tint":null,"selectedKey":["flags.midi-qol.advantage.ability.save.wis","flags.midi-qol.max.damage.heal"]}],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Compendium.dnd5e.spells.ZU9d6woBdUP8pIPt"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false}},"_id":"W2kKzBikTOSR6bWZ"}
{"_id":"X9EhbDNqAX6wzkBy","name":"Life Transference","type":"spell","img":"icons/magic/unholy/strike-beam-blood-large-red-gray.webp","data":{"description":{"value":"","chat":"","unidentified":""},"source":"Xanathar's Guide to Everything","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":null,"units":""},"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":30,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"heal","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["4d8","healing"]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":3,"school":"nec","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":false},"materials":{"value":"V,","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"1d8"},"attunement":null},"effects":[],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Item.RiuKuzeQETtPA0Pu"},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postDamageRoll]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Life Transference","type":"script","author":"U3VAAELfq3wUHjF9","img":"icons/svg/dice-target.svg","scope":"global","command":"if (args[0].macroPass === \"postDamageRoll\") {\n  let workflow = MidiQOL.Workflow.getWorkflow(args[0].uuid);\n  (await fromUuid(args[0].tokenUuid)).actor.applyDamage(workflow.damageTotal)\n  workflow.damageRoll = await new Roll(`${workflow.damageTotal*2}`).roll();\n  workflow.damageTotal = workflow.damageRoll.total;\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}}}}
{"_id":"aECR3WZ4eFwkMtYn","name":"Erupting Earth","type":"spell","img":"icons/magic/earth/barrier-stone-explosion-red.webp","data":{"description":{"value":"","chat":"","unidentified":""},"source":"Xanathar's Guide to Everything/Elemental Evil Player's Companion","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":null,"units":""},"target":{"value":20,"width":null,"units":"ft","type":"cube"},"range":{"value":120,"long":null,"units":""},"uses":{"value":null,"max":"","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["3d12","bludgeoning"]],"versatile":""},"formula":"","save":{"ability":"dex","dc":null,"scaling":"spell"},"level":3,"school":"trs","components":{"value":"","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"a piece of obsidian","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"cantrip","formula":""},"attunement":null},"effects":[],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Item.tW2gMrKTE2tjspA5"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false}}}
{"name":"Hypnotic Pattern","type":"spell","img":"systems/dnd5e/icons/spells/air-burst-magenta-2.jpg","data":{"description":{"value":"<p>You create a twisting pattern of colors that weaves through the air inside a 30-foot cube within range. The pattern appears for a moment and vanishes. Each creature in the area who sees the pattern must make a Wisdom saving throw. On a failed save, the creature becomes charmed for the duration. While charmed by this spell, the creature is incapacitated and has a speed of 0.</p><p>The spell ends for an affected creature if it takes any damage or if someone else uses an action to shake the creature out of its stupor.</p>","chat":"","unidentified":""},"source":"PHB pg. 252","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":30,"width":null,"units":"ft","type":"cube"},"range":{"value":120,"long":0,"units":"ft"},"uses":{"value":0,"max":"0","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":"","value":""},"formula":"","save":{"ability":"wis","dc":0,"scaling":"spell"},"level":3,"school":"ill","components":{"value":"","vocal":false,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"A glowing stick of incense or a crystal vial filled with phosphorescent material.","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""},"attunement":null},"effects":[{"_id":"kx7ywj9ty0lo6wwe","changes":[{"key":"data.attributes.movement.all","mode":0,"value":"*0","priority":"20"}],"disabled":false,"duration":{"startTime":null},"icon":"modules/monks-little-details/icons/smitten.svg","label":"Charmed","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":["isDamaged"],"transfer":false}},"tint":null,"selectedKey":"data.attributes.movement.all"}],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Compendium.dnd5e.spells.6g3WLOZ2u0EbaLAd"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false}},"_id":"g8Ao3rVUhMnhzImj"}
{"name":"Blink","type":"spell","img":"systems/dnd5e/icons/spells/wind-grasp-magenta-1.jpg","data":{"description":{"value":"<p>Roll a d20 at the end of each of your turns for the duration of the spell. On a roll of 11 or higher, you vanish from your current plane of existence and appear in the Ethereal Plane (the spell fails and the casting is wasted if you were already on that plane). At the start of your next turn, and when the spell ends if you are on the Ethereal Plane, you return to an unoccupied space of your choice that you can see within 10 feet of the space you vanished from. If no unoccupied space is available within that range, you appear in the nearest unoccupied space (chosen at random if more than one space is equally near). You can dismiss this spell as an action.</p><p>While on the Ethereal Plane, you can see and hear the plane you originated from, which is cast in shades of gray, and you can't see anything there more than 60 feet away. You can only affect and be affected by other creatures on the Ethereal Plane. Creatures that aren't there can't perceive you or interact with you, unless they have the ability to do so.</p>","chat":"","unidentified":""},"source":"PHB pg. 219","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"0","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":"","value":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell","value":""},"level":3,"school":"trs","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""},"attunement":null},"effects":[{"_id":"eqnig2p0nvhxtp6d","changes":[{"key":"macro.itemMacro.GM","mode":0,"value":"0","priority":"20"}],"disabled":false,"duration":{"startTime":null,"seconds":60,"rounds":10},"icon":"systems/dnd5e/icons/spells/wind-grasp-magenta-1.jpg","label":"Blink","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":false}},"tint":null,"selectedKey":"macro.itemMacro.GM"}],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Compendium.dnd5e.spells.GSvLWcdCZLQkilXT"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Blink","type":"script","author":"U3VAAELfq3wUHjF9","img":"icons/svg/dice-target.svg","scope":"global","command":"const lastArg = args[args.length-1]\nconst tokenTarget = await fromUuid(lastArg.tokenUuid)\nif(args[0] === \"on\"){    \n    let hookId = Hooks.on(\"updateCombat\",async(document)=>{    \n        if(document.previous.tokenId != targetToken.id)return;\n        let roll = new Roll('1d20').evaluate({async:false})\n        roll.toMessage(await getFlavor())\n        if(roll.total < 11)return;\n        let tokenData = duplicate(targetToken.data);\n        await targetToken.document.update({x:-100,y:-100},{ animate:false})\n        //canvas.animatePan({x:tokenData.x,y:tokenData.y})\n        let hookId2 = Hooks.on(\"updateCombat\",async(document)=>{ \n            if(document.current.tokenId != targetToken.id)return;\n            await targetToken.document.update(tokenData,{animate:false})\n            canvas.animatePan({x:tokenData.x,y:tokenData.y})\n            Hooks.off(\"updateCombat\",hookId2)\n        })\n\n    })\n    DAE.setFlag(tokenTarget.actor,\"blinkHookId\",hookId)\n}\nif(args[0] === \"off\"){\n    Hooks.off(\"updateCombat\",DAE.getFlag(tokenTarget.actor,\"blinkHookId\"))\n    DAE.unsetFlag(tokenTarget.actor,\"blinkHookId\")\n}\nasync function getFlavor(){\n    const itemOrigin = await fromUuid(lastArg.origin)\n    return {flavor:`<div class=\"dnd5e chat-card item-card midi-qol-item-card\">\\n<header class=\"card-header flexrow\">\\n<img src=\"${itemOrigin.data.img}\" width=\"36\" height=\"36\">\\n    <h3 class=\"item-name\">${itemOrigin.data.name}</h3>\\n  </header>\\n</div>`\n    }\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}}},"_id":"lfauOlD5vWRXCGly"}
{"name":"Haste","type":"spell","img":"systems/dnd5e/icons/spells/haste-royal-2.jpg","data":{"description":{"value":"<p>Choose a willing creature that you can see within range. Until the spell ends, the target's speed is doubled, it gains a +2 bonus to AC, it has advantage on Dexterity Saving Throws, and it gains an additional action on each of its turns. That action can be used only to take the Attack (one weapon attack only), Dash, Disengage, Hide, or Use an Object action.</p><p>When the spell ends, the target can't move or take Actions until after its next turn, as a wave of lethargy sweeps over it.</p>","chat":"","unidentified":""},"source":"PHB pg. 250","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":30,"long":0,"units":"ft"},"uses":{"value":0,"max":"0","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":"","value":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell","value":""},"level":3,"school":"trs","components":{"value":"","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"A shaving of licorice root","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""},"attunement":null},"effects":[{"_id":"vy93iqb92wifoqjz","changes":[{"key":"data.attributes.ac.bonus","mode":2,"value":"2","priority":"20"},{"key":"data.attributes.movement.all","mode":0,"value":"*2","priority":"20"},{"key":"flags.midi-qol.advantage.ability.save.dex","mode":2,"value":"0","priority":"20"}],"disabled":false,"duration":{"startTime":null,"seconds":60,"rounds":10},"icon":"systems/dnd5e/icons/spells/haste-royal-2.jpg","label":"Haste","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":false}},"tint":null,"selectedKey":["data.attributes.ac.bonus","data.attributes.movement.all","flags.midi-qol.advantage.ability.save.dex"]}],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Compendium.dnd5e.spells.Szvk5FEVQW3uhJi5"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false}},"_id":"rpMi08NhQpuLFesZ"}
{"_id":"ssGmIX5QzLqo4QnT","name":"Melf's Minute Meteors","type":"spell","img":"icons/magic/fire/projectile-fireball-sparks-orange.webp","data":{"description":{"value":"","chat":"","unidentified":""},"source":"Xanathar's Guide to Everything","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":10,"units":"minute"},"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":3,"school":"evo","components":{"value":"","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"niter, sulfur, and pine tar formed into a bead","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"cantrip","formula":""},"attunement":null},"effects":[],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Item.tqR9E1zeUoTUh4Or"},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Melf's Minute Meteors","type":"script","author":"U3VAAELfq3wUHjF9","img":"icons/svg/dice-target.svg","scope":"global","command":"const spellLevel = args[0].spellLevel;\nactor = await fromUuid(args[0].actorUuid);\nlet itemData = {\n    name: \"Send \" + args[0].itemData.name,\n    type: \"spell\",\n    img: args[0].itemData.img,\n    data: {\n        description: {\n                value: \"<p>you can expend one or two of the meteors, sending them streaking toward a point or points you choose within 120 feet of you. Once a meteor reaches its destination or impacts against a solid surface, the meteor explodes. Each creature within 5 feet of the point where the meteor explodes must make a Dexterity saving throw. A creature takes 2d6 fire damage on a failed save, or half as much damage on a successful one.</p>\"},\n        actionType: \"save\",\n        activation: {type: \"bonus\",cost: 1},\n        damage: {parts: [[\"2d6\", \"fire\"]]},\n        target: {value: 5,units: \"ft\",type: \"sphere\"},\n        range: {value: 120, units: \"ft\"},\n        save: {ability: \"dex\",dc: null,scaling: \"spell\"},\n        level: 0,\n        school: \"evo\",\n        uses: {value: 2*spellLevel, max: 2*spellLevel, per: 'charges'},\n    }\n};\nlet items = await actor.createEmbeddedDocuments(\"Item\", [itemData]);\nitemData.name = \"Send 2 \" + args[0].itemData.name\nitemData.data.consume = {type: 'charges', target: items[0].id, amount: 2}\nitemDatauses = {value: spellLevel, max: spellLevel, per: 'charges'}\nlet items2 = await actor.createEmbeddedDocuments(\"Item\", [itemData]);\nitems = items.concat(items2)\nlet removeUuids = getProperty(actor.data.flags, \"midi-qol.concentration-data.removeUuids\") ?? [];\nremoveUuids = removeUuids.concat(items.map(i=>i.uuid));\nif (removeUuids.length > 0) actor.setFlag(\"midi-qol\", \"concentration-data.removeUuids\", removeUuids);","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}}}}
{"name":"Fear","type":"spell","img":"systems/dnd5e/icons/spells/horror-eerie-2.jpg","data":{"description":{"value":"<p>You project a phantasmal image of a creature's worst fears. Each creature in a 30-foot cone must succeed on a Wisdom saving throw or drop whatever it is holding and become Frightened for the duration.</p><p>While Frightened by this spell, a creature must take the Dash action and move away from you by the safest available route on each of its turns, unless there is nowhere to move. If the creature ends its turn in a location where it doesn't have line of sight to you, the creature can make a Wisdom saving throw. On a successful save, the spell ends for that creature.</p>","chat":"","unidentified":""},"source":"PHB pg. 239","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":30,"width":null,"units":"ft","type":"cone"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"0","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":"","value":""},"formula":"","save":{"ability":"wis","dc":0,"scaling":"spell"},"level":3,"school":"ill","components":{"value":"","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"A white feather or the heart of a hen.","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""},"attunement":null},"effects":[{"_id":"xbwsmegfh4mi6566","changes":[{"key":"flags.midi-qol.disadvantage.attack.all","mode":2,"value":"0","priority":"20"},{"key":"flags.midi-qol.disadvantage.ability.check.all","mode":2,"value":"0","priority":"20"},{"key":"macro.itemMacro","mode":0,"value":"0","priority":"20"}],"disabled":false,"duration":{"startTime":null,"seconds":60,"rounds":10},"icon":"icons/svg/terror.svg","label":"Frightened","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":false}},"tint":null,"selectedKey":["flags.midi-qol.disadvantage.attack.all","flags.midi-qol.disadvantage.ability.check.all","macro.itemMacro.GM"]}],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Compendium.dnd5e.spells.XXUDGFELgoskdOD0"},"itemacro":{"macro":{"data":{"_id":null,"name":"Fear","type":"script","author":"U3VAAELfq3wUHjF9","img":"icons/svg/dice-target.svg","scope":"global","command":"if(args[0] === \"on\"){\n    const lastArg = args[args.length-1];\n    const tokenTarget = await fromUuid(lastArg.tokenUuid);\n    const origin = await fromUuid(lastArg.origin);\n    const originActor = origin.parent\n    let hookId = Hooks.on(\"updateCombat\",(document)=>{\n        if(document.current.tokenId === lastArg.tokenId){\n            let text = `While frightened, ${tokenTarget.name} must take the Dash action and move away from ${originActor.name} by the safest available route.`\n            ui.notifications.notify(text)\n            let flavor = getFlavor(origin)\n            ChatMessage.create({content:text,flavor})\n            Hooks.off(\"updateCombat\",hookId)\n        }\n    })\n}\n\nfunction getFlavor(origin){\n    return `<div class=\"dnd5e chat-card item-card midi-qol-item-card\">\\n<header class=\"card-header flexrow\">\\n<img src=\"${origin.img}\" width=\"36\" height=\"36\">\\n    <h3 class=\"item-name\">${origin.name}</h3>\\n  </header>\\n</div>`\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false}},"_id":"tRLosHgBlYC6lRll"}
{"_id":"uF1D2Kow22blFn1J","name":"Intellect Fortress","type":"spell","img":"icons/magic/control/control-influence-rally-purple.webp","data":{"description":{"value":"","chat":"","unidentified":""},"source":"Tasha's Cauldron of Everything","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"hour"},"target":{"value":null,"width":null,"units":"","type":"creature"},"range":{"value":30,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":3,"school":"abj","components":{"value":"","vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"cantrip","formula":""},"attunement":null},"effects":[{"_id":"yu654t7rg8rjqtvs","changes":[{"key":"data.traits.dr.value","mode":2,"value":"psychic","priority":"20"},{"key":"flags.midi-qol.advantage.ability.save.int","mode":2,"value":"0","priority":"20"},{"key":"flags.midi-qol.advantage.ability.save.wis","mode":2,"value":"0","priority":"20"},{"key":"flags.midi-qol.advantage.ability.save.cha","mode":2,"value":"0","priority":"20"}],"disabled":false,"duration":{"startTime":null,"seconds":3600,"rounds":600},"icon":"icons/magic/control/control-influence-rally-purple.webp","label":"Intellect Fortress","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":false}},"tint":null,"selectedKey":["data.traits.dr.value","flags.midi-qol.advantage.ability.save.int","flags.midi-qol.advantage.ability.save.wis","flags.midi-qol.advantage.ability.save.cha"]}],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Item.vLIqfMtHk0zr1hXr"}}}
{"name":"Call Lightning","type":"spell","img":"systems/dnd5e/icons/spells/lighting-sky-2.jpg","data":{"description":{"value":"<p>A storm cloud appears in the shape of a cylinder that is 10 feet tall with a 60-foot radius, centered on a point you can see 100 feet directly above you. The spell fails if you can't see a point in the air where the storm cloud could appear (for example, if you are in a room that can't accommodate the cloud).</p>\n<p>When you cast the spell, choose a point you can see within range. A bolt of lightning flashes down from the cloud to that point. Each creature within 5 feet of that point must make a Dexterity saving throw. A creature takes 3d10 lightning damage on a failed save, or half as much damage on a successful one. On each of your turns until the spell ends, you can use your action to call down lightning in this way again, targeting the same point or a different one.</p>\n<p>If you are outdoors in stormy conditions when you cast this spell, the spell gives you control over the existing storm instead of creating a new one. Under such conditions, the spell's damage increases by 1d10.</p>\n<p><strong>Higher Levels.</strong> When you cast this spell using a spell slot of 4th or higher level, the damage increases by 1d10 for each slot level above 3rd.</p>","chat":"","unidentified":""},"source":"PHB pg. 220","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":10,"units":"minute"},"target":{"value":60,"width":null,"units":"ft","type":"cylinder"},"range":{"value":120,"long":0,"units":"ft"},"uses":{"value":0,"max":"0","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":"4d10"},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":3,"school":"con","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"1d10"},"attunement":null},"effects":[],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Compendium.dnd5e.spells.ehvmg9U9fcMEhE4z"},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Call Lightning","type":"script","author":"U3VAAELfq3wUHjF9","img":"icons/svg/dice-target.svg","scope":"global","command":"const spellLevel = args[0].spellLevel;\nactor = await fromUuid(args[0].actorUuid);\nconst itemData = {\n    name: args[0].itemData.name + \" Bolt\",\n    type: \"spell\",\n    img: args[0].itemData.img,\n    data: {\n        description: {\n                value: \"<p>When you cast the spell, choose a point you can see within range. A bolt of lightning flashes down from the cloud to that point. Each creature within 5 feet of that point must make a Dexterity saving throw. A creature takes 3d10 lightning damage on a failed save, or half as much damage on a successful one. On each of your turns until the spell ends, you can use your action to call down lightning in this way again, targeting the same point or a different one.</p>\"},\n        actionType: \"save\",\n        activation: {type: \"action\"},\n        damage: {parts: [[`${spellLevel}d10`, \"lightning\"]]},\n        target: {value: 5,units: \"ft\",type: \"sphere\"},\n        range: {value: 150, units: \"ft\"},\n        save: {ability: \"dex\",dc: null,scaling: \"spell\"},\n        level: 0,\n        school: \"con\",\n    }\n};\nconst items = (await actor.createEmbeddedDocuments(\"Item\", [itemData])).map(i=> i.uuid);\nlet removeUuids = getProperty(actor.data.flags, \"midi-qol.concentration-data.removeUuids\") ?? [];\nremoveUuids = removeUuids.concat(items);\nif (removeUuids.length > 0) actor.setFlag(\"midi-qol\", \"concentration-data.removeUuids\", removeUuids);","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}}},"_id":"wF4nNztZ65d04pS3"}
{"_id":"xk1WemQEePlpuopm","name":"Crusaders Mantle","type":"spell","img":"icons/magic/holy/projectiles-blades-salvo-yellow.webp","data":{"description":{"value":"","chat":"","unidentified":""},"source":"Player's Handbook","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":3,"school":"evo","components":{"value":"","vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"cantrip","formula":""},"attunement":null},"effects":[{"_id":"qa0objd6wdquo7v3","changes":[{"key":"macro.itemMacro.GM","mode":0,"value":"0","priority":"20"},{"key":"data.bonuses.mwak.damage","mode":2,"value":"1d4[radiant]","priority":"20"},{"key":"data.bonuses.rwak.damage","mode":2,"value":"1d4[radiant]","priority":"20"}],"disabled":false,"duration":{"startTime":null},"icon":"icons/magic/holy/projectiles-blades-salvo-yellow.webp","label":"Crusaders Mantle","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":false}},"tint":null,"selectedKey":["macro.itemMacro.GM","data.bonuses.mwak.damage","data.bonuses.rwak.damage"]}],"folder":null,"sort":0,"permission":{"default":0,"U3VAAELfq3wUHjF9":3},"flags":{"core":{"sourceId":"Item.RybQtr8bbepnod6g"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Crusaders Mantle","type":"script","author":"U3VAAELfq3wUHjF9","img":"icons/svg/dice-target.svg","scope":"global","command":"const lastArg = args[args.length-1]\nconst tokenTarget = await fromUuid(lastArg.tokenUuid)\nconst origin = lastArg.origin\nconst originItem = await fromUuid(origin)\nif(args[0] === \"on\"){\n    for(let token of canvas.tokens.placeables){\n        let distance = canvas.grid.measureDistance(tokenTarget.object,token)\n        if(distance > 30)continue;\n        if(token.data.disposition != tokenTarget.data.disposition)continue;\n        if(token.id === tokenTarget.id)continue;\n        await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: token.actor.uuid, effects: [getEffectData()]});\n    }\n    let hookId = Hooks.on(\"updateToken\",async(document,updates)=>{\n        if(!('x' in updates||'y' in updates))return;\n        let position = {x:updates.x??document.data.x,y:updates.y??document.data.y}\n        if(document.id === tokenTarget.id){            \n            for(let token of canvas.tokens.placeables){\n                if(token.data.disposition != tokenTarget.data.disposition)continue;            \n                let distance = canvas.grid.measureDistance(position,token);\n                if(distance > 30){\n                    if(token.id != tokenTarget.id){\n                        token.actor.effects.find(i=>i.data.origin === origin)?.delete()\n                    }\n                }\n                else{\n                    if(!token.actor.effects.find(i=>i.data.origin === origin)){       \n                        await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: token.actor.uuid, effects: [getEffectData()]});\n                    }\n                }\n            }\n        }\n        else{\n            if(document.data.disposition != tokenTarget.data.disposition)return;\n            let distance = canvas.grid.measureDistance(position,tokenTarget.object);\n            if(distance > 30){\n                document.actor.effects.find(i=>i.data.origin === origin)?.delete()\n            }\n            else{\n                if(!document.actor.effects.find(i=>i.data.origin === origin)){       \n                        await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: document.actor.uuid, effects: [getEffectData()]});\n                    }\n            }\n        }\n    })\n    DAE.setFlag(tokenTarget.actor,\"crusadersMantleHookId\",hookId)\n}\nif(args[0] === \"off\"){\n    Hooks.off(\"updateToken\",DAE.getFlag(tokenTarget.actor,\"crusadersMantleHookId\"))\n    DAE.unsetFlag(tokenTarget.actor,\"crusadersMantleHookId\")\n    for(let token of canvas.tokens.placeables){\n        token.actor.effects.find(i=>i.data.origin === origin)?.delete()\n    }\n}\n\n\nfunction getEffectData(){\n    return {\n        \"changes\": [\n            {\n                \"key\": \"data.bonuses.mwak.damage\",\n                \"mode\": 2,\n                \"value\": \"1d4[radiant]\",\n                \"priority\": \"20\"\n            },\n            {\n                \"key\": \"data.bonuses.rwak.damage\",\n                \"mode\": 2,\n                \"value\": \"1d4[radiant]\",\n                \"priority\": \"20\"\n            }\n        ],\n        \"disabled\": false,\n        \"duration\": {\n            \"rounds\": 10,\n            \"startTime\": null,\n            \"seconds\": 60\n        },\n        \"icon\": originItem.data.img,\n        \"label\": originItem.data.name,\n        \"origin\": origin,\n        \"tint\": \"\",\n        \"transfer\": false,\n        \"flags\": {\n            \"dae\": {\n                \"transfer\": true,\n                \"stackable\": \"multi\",\n                \"macroRepeat\": \"none\",\n                \"specialDuration\": []\n            },\n        }\n    }\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}}}}
